<!DOCTYPE html>
<!--Forrés: AI-->
<html lang="hu">

<head>

  <meta charset="UTF-8">
  <title>U7W4RZ Órarend JSON - Lista</title>
  <style>
    * {
        box-sizing:border-box;
    }
    body {
        font-family:Segoe UI,Arial,sans-serif;
        margin:20px;
        background:#f5f5f5;
    }
    .container {
        max-width:900px;
        margin:auto;
    }
    h1 {
        font-size:22px;
        margin-bottom:10px;
    }
    .panel {
        background:#fff;
        border:1px solid #ccc;
        border-radius:4px;
        padding:10px 15px;
        margin-bottom:15px;
    }
    .form-row {
        margin-bottom:8px;
    }
    label {
        font-size:12px;
        font-weight:600;
        margin-right:5px;
    }
    input[type=text] {
        padding:5px 7px;
        border:1px solid #ccc;
        border-radius:3px;
        width:200px;
    }
    input[type=file] {
        font-size:12px;
    }
    button {
        padding:5px 10px;
        font-size:12px;
        border-radius:3px;
        border:1px solid #888;
        background:#eee;
        cursor:pointer;
    }
    button:hover {
        background:#ddd;
    }
    #result {
        min-height:120px;
        border:1px solid #ddd;
        border-radius:4px;
        padding:10px;
        background:#fff;
        white-space:pre-line;
    }
    .item {
        margin-bottom:10px;
        padding-bottom:8px;
        border-bottom:1px solid #eee;
    }
    .title {
        font-weight:700;
    }
  </style>

</head>

<body>

    <div class="container">
        <h1>U7W4RZ Órarend JSON</h1>

        <div class="panel">
            <div class="form-row">
                <label>Fájl kiválasztása</label>
                <input type="file" id="file" accept=".json">
                <button id="loadFileBtn">LocalStorage betöltése</button>
                </div>
                <div class="form-row">
                <label for="search">Keresés tárgy szerint:</label>
                <input type="text" id="search" placeholder="pl. Szoftverfejlesztés">
            </div>
        </div>

        <div id="result" class="panel"></div>
    </div>

    <script>
        const DB_KEY = 'neptunkod_orarend_db';
        var lessons = JSON.parse(localStorage.getItem(DB_KEY) || '[]');

        const $ = id => document.getElementById(id);

        const saveStore = () =>
            localStorage.setItem(DB_KEY, JSON.stringify(lessons));

        const renderList = () => {
            const box = $('result');
            const term = $('search').value.toLowerCase();
            var data = lessons;
            if (term) data = data.filter(o => o.targy.toLowerCase().includes(term));
            if (!data.length) {
                box.textContent = 'Nincs megjeleníthető adat.';
                return;
            }
            box.innerHTML = data.map(o => `
            <div class="item">
                <div class="title">${o.targy}</div>
                Nap: ${o.nap}<br>
                Idő: ${o.tol} - ${o.ig}<br>
                Helyszín: ${o.helyszin}<br>
                Oktató: ${o.oktato}<br>
                Szak: ${o.szak}
            </div>`).join('');
        };

        $('search').oninput = renderList;
        $('loadFileBtn').onclick = () => {
            lessons = JSON.parse(localStorage.getItem(DB_KEY) || '[]');
            renderList();
        };

        $('file').addEventListener('change', e => {
            const file = e.target.files[0];
            if (!file) return;
            const r = new FileReader();
            r.onload = ev => {
            try{
                const data = JSON.parse(ev.target.result);      
                const ora = data.XY_Orarend?.ora;              
                if (!Array.isArray(ora)) throw new Error();
                lessons = ora;
                saveStore();
                renderList();
            }catch{
                alert('Hibás JSON fájl!');
            }
            };
            r.readAsText(file);
        });

        renderList();
    </script>

</body>

</html>
